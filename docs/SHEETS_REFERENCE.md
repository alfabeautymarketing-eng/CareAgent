# AgentCare - Справочник листов и колонок

## Обзор

Этот документ содержит полный список листов Google Sheets и их колонок для каждого проекта.

---

## Реестр листов

| Код | Название листа | Описание | MT | SK | SS |
|-----|----------------|----------|----|----|-----|
| PRIMARY | Главная | Основной лист с артикулами | ✓ | ✓ | ✓ |
| CERTIFICATION | Сертификация | Данные сертификации | ✓ | ✓ | ✓ |
| LABELS | Этикетки | Тексты для этикеток | ✓ | ✓ | ✓ |
| NEWS | New sert | Новинки для сертификации | ✓ | ✓ | ✓ |
| INVOICE_FULL | Для таможни | Инвойс для таможни | ✓ | ✓ | ✓ |
| ORDER | Ордер | Заказ от поставщика | ✓ | ✓ | ✓ |
| ORDER_FORM | Заказ | Форма заказа | ✓ | ✓ | ✓ |
| PRICE | Прайс | Прайс-лист | ✓ | ✓ | ✓ |
| STOCKS | -остатки | Остатки товаров | ✓ | ✓ | ✓ |
| PRICE_DYNAMICS | Динамика цены | История изменения цен | ✓ | ✓ | ✓ |
| PRICE_CALCULATION | Расчет цены | Расчёт цен | ✓ | ✓ | ✓ |
| ABC_ANALYSIS | ABC-Анализ | ABC анализ товаров | ✓ | ✓ | - |
| TZ_BY_STATUS | ТЗ по статусам | ТЗ по статусам | ✓ | - | - |
| ORDER_VERIFICATION | Сверка заказа | Сверка заказа | ✓ | - | - |
| FOR_DATABASE | Для базы | Выгрузка для базы | ✓ | ✓ | - |
| LOCAL_LOOKUP | Вид и код | Справочник кодов | ✓ | ✓ | ✓ |
| RULES | Правила синхро | Настройки синхронизации | ✓ | ✓ | ✓ |
| LOG | Журнал синхро | Лог синхронизации | ✓ | ✓ | ✓ |
| LOG_DEBUG | Журнал логов | Debug логи | ✓ | ✓ | ✓ |
| EXTERNAL_DOCS | Внешние документы | Ссылки на документы | ✓ | ✓ | ✓ |

---

## Структура колонок по листам

### Главная (PRIMARY)

Основной лист с данными о товарах.

| Колонка | Тип | Описание | Синхро |
|---------|-----|----------|--------|
| ID | string | Уникальный идентификатор в базе | → все листы |
| ID-P | string | ID-P на листе "Главная" | → все листы |
| Статус | enum | Статус товара (Активный, Неактивный, Новинка, Архив) | → Сертификация, Заказ |
| Примечание/записная книжка | text | Заметки | - |
| Арт. Рус | string | Русский артикул | → все листы |
| Арт. произв. | string | Артикул производителя | → все листы |
| Код база | string | Код в базе | → Сертификация, Прайс |
| Код в 1С | string | Код в 1С | → Расчет цены |
| Название ENG прайс произв | string | Английское название из прайса | → Инвойс |
| Наименования англ по ДС | string | Англ. название по декларации | → Сертификация, Этикетки |
| Наименования рус по ДС | string | Рус. название по декларации | → Сертификация, Этикетки, Заказ |
| Объём | string | Объём товара | → все листы |
| Форма выпуска | string | Форма выпуска | → Прайс |
| шт./уп. | number | Штук в упаковке | → Заказ |
| Категория товара | string | Категория | → Прайс, Этикетки |
| Линия | string | Линия товаров | → Прайс |
| Группа | string | Группа товаров | → Прайс |
| BAR CODE | string | Штрихкод | → Сертификация |
| ID-G | string | ID группы (для пробников) | → Прайс (SK only) |
| ID-L | string | ID линии | → Прайс |

### Сертификация (CERTIFICATION)

Данные для сертификации товаров.

| Колонка | Тип | Описание |
|---------|-----|----------|
| ID | string | Идентификатор |
| Статус | enum | Статус |
| Наименования англ по ДС | string | Англ. название |
| Наименования рус по ДС | string | Рус. название |
| Наименование ДС | string | Название для декларации |
| Объём | string | Объём |
| Наименование для инвойса | string | Название в инвойсе |
| Объём англ. | string | Объём на английском |
| Наименование для инвойса Англ | string | Англ. название в инвойсе |
| Примечание/записная книжка | text | Заметки |
| Арт. Рус | string | Русский артикул |
| Арт. произв. | string | Артикул производителя |
| Код база | string | Код в базе |
| Код в 1С | string | Код в 1С |
| BAR CODE | string | Штрихкод |
| код категории | string | Код категории ТН ВЭД |
| категория | string | Категория |
| Вид продукции | string | Вид продукции |
| Код ТН ВЭД | string | Код ТН ВЭД (3304, 3305, 3307) |
| ДС | link | Ссылка на декларацию |
| ДС до | date | Срок действия ДС |
| номер ДС | string | Номер декларации |
| Протокол ДС | link | Ссылка на протокол |
| Протокол доп | link | Доп. протокол |
| Скан спирт | link | Скан справки спирт |
| Спирт До | date | Срок действия справки |
| INCI | link | Ссылка на INCI |
| COA | link | Certificate of Analysis |
| Этикетка | link | Ссылка на этикетку |

### Этикетки (LABELS)

Тексты для этикеток.

| Колонка | Тип | Описание |
|---------|-----|----------|
| ID | string | Идентификатор |
| Статус | enum | Статус |
| Арт. Рус | string | Русский артикул |
| Категория товара | string | Категория |
| Объём | string | Объём |
| Наименования рус по ДС | string | Рус. название |
| Наименования англ по ДС | string | Англ. название |
| Назначение Этикетка | text | Назначение (текст для этикетки) |
| Применение Этикетка | text | Применение (текст для этикетки) |
| Активные ингредиенты без % | text | Активные ингредиенты |
| описание БУКЛЕТ | text | Описание для буклета |
| применение БУКЛЕТ | text | Применение для буклета |
| состав БУКЛЕТ | text | Состав для буклета |
| История статусов | text | История изменения статусов |

### Для таможни (INVOICE_FULL)

Инвойс для таможенного оформления.

| Колонка | Тип | Описание |
|---------|-----|----------|
| ID | string | Идентификатор |
| Арт. Рус | string | Русский артикул |
| Арт. произв. | string | Артикул производителя |
| Наименование | string | Название товара |
| Наименование Англ | string | Англ. название |
| кол-во | number | Количество |
| Цена ед. | number | Цена за единицу |
| Сумма | number | Сумма (кол-во × цена) |
| ДС | link | Ссылка на декларацию |
| ДС до | date | Срок действия |
| номер ДС | string | Номер декларации |
| Спирт | link | Справка спирт |
| Спирт до | date | Срок справки |
| статус | enum | Статус |
| Примечание | text | Примечание |
| Назначение Этикетка | text | Назначение |
| Применение Этикетка | text | Применение |
| Активные ингредиенты без % | text | Активные ингредиенты |

### Заказ (ORDER_FORM)

Форма заказа товаров.

| Колонка | Тип | Описание |
|---------|-----|----------|
| ID | string | Идентификатор |
| ID-P | string | ID-P |
| Статус | enum | Статус |
| Арт. Рус | string | Русский артикул |
| Арт. произв. | string | Артикул производителя |
| Название ENG прайс произв | string | Англ. название |
| Наименования рус по ДС | string | Рус. название |
| Объём | string | Объём |
| шт./уп. | number | Штук в упаковке |
| ПРОДАЖИ | number | Продажи за период |
| Остаток | number | Текущий остаток |
| товар в ПУТИ | number | В пути |
| Остаток 1 | number | Остаток партия 1 |
| СГ 1 | date | Срок годности партия 1 |
| Остаток 2 | number | Остаток партия 2 |
| СГ 2 | date | Срок годности партия 2 |
| Остаток3 | number | Остаток партия 3 |
| СГ 3 | date | Срок годности партия 3 |
| СПИСАНО | number | Списано |
| РЕЗЕРВ | number | В резерве |
| Среднемесячные продажи, шт | number | Средние продажи |
| Потребность на 6 месяцев, шт | number | Потребность |
| На сколько мес запас | number | Запас в месяцах |
| Необходимо заказать, шт | number | Рекомендация заказа |
| Предварительный заказ | number | Предзаказ |
| заказ в упаковках | number | Заказ упаковками |
| ЗАКАЗ | number | Итоговый заказ |
| EXW ALFASPA текущая, € | number | Цена EXW |
| Предварительная сумма заказа | number | Сумма |
| АКЦИИ | text | Акции |
| условие# | text | Условие акции |
| коментарий# | text | Комментарий |
| Срок# | date | Срок акции |
| Набор | text | Набор |
| условие | text | Условие |
| коментарий | text | Комментарий |
| Срок | date | Срок |
| Добавить в прайс | boolean | Добавить в прайс |
| Категория товара | string | Категория |
| Группа линии | string | Группа |
| Линия Прайс | string | Линия |
| Примечание | text | Примечание |
| Продублировать | boolean | Дублировать |

### Прайс (PRICE)

Прайс-лист.

| Колонка | Тип | Описание |
|---------|-----|----------|
| ID | string | Идентификатор |
| ID-L | string | ID линии |
| Статус | enum | Статус |
| Категория товара | string | Категория |
| Код база | string | Код в базе |
| Арт. Рус | string | Русский артикул |
| Наименование | string | Название |
| Примечание | text | Примечание |
| Объём | string | Объём |
| Для | string | Для кого |
| Картинка | link | Картинка 1 |
| Картинка 2 | link | Картинка 2 |
| Цена | number | Цена |
| RRP | number | Рекомендованная розничная цена |
| Е-comerc | number | Цена e-commerce |
| Группа линии | string | Группа |
| Линия Прайс | string | Линия |
| Продублировать | boolean | Дублировать |
| Линия Рус | string | Русское название линии |

### Динамика цены (PRICE_DYNAMICS)

История изменения цен.

| Колонка | Тип | Описание |
|---------|-----|----------|
| ID | string | Идентификатор |
| ID-P | string | ID-P |
| Статус | enum | Статус |
| Арт. Рус | string | Русский артикул |
| Арт. произв. | string | Артикул производителя |
| Код база | string | Код в базе |
| Код в 1С | string | Код в 1С |
| Название ENG прайс произв | string | Англ. название |
| Наименования англ по ДС | string | Англ. по ДС |
| Наименования рус по ДС | string | Рус. по ДС |
| Объём | string | Объём |
| ЦЕНА EXW из Б/З | number | Цена EXW из Б/З |
| Комментарий | text | Комментарий |
| EXW 2025, € | number | EXW 2025 |
| СКИДКА ОТ EXW 2025, % | number | Скидка |
| EXW ALFASPA 2025, € | number | EXW Alfaspa |
| Закупочная цена 2025, ₽ | number | Закупочная цена |
| DDP-МОСКВА 2025, ₽ | number | DDP Москва |
| Прирост EXW, € | number | Изменение EXW |
| Прирост DDP-МОСКВА, ₽ | number | Изменение DDP |

### Расчет цены (PRICE_CALCULATION)

Расчёт цен.

| Колонка | Тип | Описание |
|---------|-----|----------|
| ID | string | Идентификатор |
| ID-P | string | ID-P |
| Статус | enum | Статус |
| Арт. Рус | string | Русский артикул |
| Арт. произв. | string | Артикул производителя |
| Код база | string | Код в базе |
| Код в 1С | string | Код в 1С |
| Название ENG прайс произв | string | Англ. название |
| Наименования англ по ДС | string | Англ. по ДС |
| Наименования рус по ДС | string | Рус. по ДС |
| Объём | string | Объём |
| ЦЕНА EXW из Б/З | number | Цена EXW из Б/З |
| Комментарий | text | Комментарий |
| EXW предыдущая, € | number | Предыдущая цена |
| EXW текущая, € | number | Текущая цена |
| EXW ALFASPA текущая, € | number | Цена Alfaspa |
| Закупочная цена, ₽ | number | Закупочная |
| DDP -МОСКВА, ₽ | number | DDP |

### ABC-Анализ (ABC_ANALYSIS)

ABC анализ товаров.

| Колонка | Тип | Описание |
|---------|-----|----------|
| ID | string | Идентификатор |
| ID-P | string | ID-P |
| Статус | enum | Статус |
| Арт. Рус | string | Русский артикул |
| Арт. произв. | string | Артикул производителя |
| Код база | string | Код в базе |
| Код в 1С | string | Код в 1С |
| Название ENG прайс произв | string | Англ. название |

---

## Связи между листами

### Ключевые поля для связи

| Поле | Описание | Используется в |
|------|----------|----------------|
| ID | Главный ключ | Все листы |
| ID-P | Альтернативный ключ | Главная, Заказ, Динамика, Расчет, ABC |
| Арт. Рус | Человекочитаемый ключ | Все листы |
| Арт. произв. | Ключ поставщика | Главная, Инвойс, Заказ |

### Направление синхронизации

```
Главная (источник)
    │
    ├──→ Сертификация
    │         ├──→ New sert (Новинки)
    │         └──→ Для таможни (Инвойс)
    │
    ├──→ Этикетки
    │
    ├──→ Заказ
    │         └──→ Ордер
    │
    ├──→ Прайс
    │
    ├──→ Динамика цены
    │
    ├──→ Расчет цены
    │
    └──→ ABC-Анализ
```

---

## Правила валидации

### Статусы

```yaml
allowed_values:
  - "Активный"
  - "Неактивный"
  - "Новинка"
  - "New в работу"
  - "Архив"
```

### Код ТН ВЭД

```yaml
allowed_values:
  - "3304"  # Косметические средства для кожи
  - "3305"  # Средства для волос
  - "3307"  # Прочие парфюмерные средства
```

### Типы документов

```yaml
doc_types:
  - "353пп"
  - "ДС"
  - "СГР"
```

---

## Особенности по проектам

### MT (CosmeticaBar)

- **Тестеры:** Есть колонка для тестеров
- **ID-G:** Используется для группировки пробников
- **Полный набор листов:** Все 20 листов

### SK (Carmado)

- **RRP:** Рекомендованная розничная цена
- **Скидки:** Категорийные скидки
- **Пробники:** ID-G для группировки
- **Листы:** 18 листов (без TZ_BY_STATUS, ORDER_VERIFICATION)

### SS (ООО Сан)

- **Базовый:** Минимальный набор функций
- **Листы:** 15 листов (без ABC, TZ_BY_STATUS, ORDER_VERIFICATION, FOR_DATABASE)
- **Без RRP и скидок**
